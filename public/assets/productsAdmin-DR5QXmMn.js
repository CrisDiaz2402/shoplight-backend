import{d as j,r as g,o as q,s as I,l as m,v as R,c as n,a as e,b as d,u as a,I as l,x as U,t as c,F as B,e as L,h as r,_ as T}from"./index-C5EFz0i3.js";import{u as V}from"./useProducts-LmEOPVqc.js";import{D as z}from"./deletedPanel-It5FEFuC.js";const F={class:"space-y-6"},M={class:"bg-white text-slate-900 p-8 rounded-md border border-slate-200"},G={class:"flex items-center justify-between gap-4"},Q={key:0,class:"flex items-center justify-center p-8"},H={key:1,class:"bg-red-50 border border-red-200 rounded-md p-4 text-red-700"},J={class:"flex items-center"},K={key:2,class:"bg-white rounded-lg shadow overflow-hidden"},O={key:0,class:"text-center py-12"},W={class:"text-slate-500"},X={key:1,class:"min-w-full"},Y={class:"bg-white divide-y divide-slate-200"},Z={class:"px-4 py-4"},ee={class:"w-16 h-12 overflow-hidden rounded-md bg-slate-100 flex items-center justify-center"},te=["src","alt"],se={key:1,class:"text-slate-400 text-xs"},oe={class:"px-6 py-4 whitespace-nowrap"},ae={class:"text-sm font-medium text-slate-900"},ne={class:"px-6 py-4"},re={class:"text-sm text-slate-500"},ie={class:"px-6 py-4"},ce={class:"text-sm text-slate-500"},de={class:"px-6 py-4"},le={class:"text-sm text-slate-500"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-500"},me={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},pe={class:"flex items-center justify-end gap-2"},xe=["onClick"],he=["onClick"],fe=j({__name:"productsAdmin",setup(_e){const p=R(),x=I(),{filteredProducts:h,loading:y,error:f,searchQuery:v,fetchProducts:_,deleteProduct:w,clearError:b}=V(),u=g(!1),i=g(null);q(async()=>{await _();const t=x.query.success,s=x.query.name;t&&s&&(setTimeout(()=>{t==="created"?m.success(`Producto "${s}" creado exitosamente`,{autoClose:2e3}):t==="updated"&&m.success(`Producto "${s}" actualizado exitosamente`,{autoClose:2e3})},100),p.replace({path:x.path}))});function k(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}}function C(t){return t==null?"—":t.toLocaleString("en-US",{style:"currency",currency:"USD"})}function P(){p.push("/adminproductos/productos/crear")}function D(t){p.push(`/adminproductos/productos/${t.id}/editar`)}function N(t){i.value=t,u.value=!0}async function E(){if(i.value)try{const t=i.value.name;await w(i.value.id),m.success(`Producto "${t}" eliminado exitosamente`,{autoClose:2e3}),u.value=!1,i.value=null}catch(t){console.error("Error al eliminar producto:",t);const s=t?.response?.data?.error||t?.response?.data?.message||"Error al eliminar el producto";m.error(s,{autoClose:2e3})}}function A(){u.value=!1,i.value=null}function S(){b(),_()}return(t,s)=>(r(),n("section",F,[e("header",M,[e("div",G,[s[1]||(s[1]=e("div",null,[e("h1",{class:"text-3xl md:text-4xl font-extrabold"},"Gestión de Productos"),e("p",{class:"text-slate-600 mt-2"},"Administra el inventario de productos")],-1)),e("button",{onClick:P,class:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md shadow"},[d(a(l),{icon:"mdi:plus",width:"18",height:"18"}),s[0]||(s[0]=e("span",null,"Crear Producto",-1))])])]),e("main",null,[a(y)?(r(),n("div",Q,[...s[2]||(s[2]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),e("span",{class:"ml-2 text-slate-600"},"Cargando productos...",-1)])])):a(f)?(r(),n("div",H,[e("div",J,[d(a(l),{icon:"mdi:alert-circle",width:"20",height:"20",class:"mr-2"}),U(" "+c(a(f)),1)]),e("button",{onClick:S,class:"mt-2 text-red-800 underline hover:no-underline"},"Reintentar")])):(r(),n("div",K,[a(h).length===0?(r(),n("div",O,[d(a(l),{icon:"mdi:package-variant-closed",width:"48",height:"48",class:"mx-auto text-slate-300 mb-4"}),s[3]||(s[3]=e("h3",{class:"text-lg font-medium text-slate-900 mb-2"},"No hay productos",-1)),e("p",W,c(a(v)?"No se encontraron productos que coincidan con tu búsqueda.":"Comienza creando tu primer producto."),1)])):(r(),n("table",X,[s[4]||(s[4]=e("thead",{class:"bg-slate-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Imagen"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Nombre"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Precio"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Stock"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Categoría"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Creado"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",Y,[(r(!0),n(B,null,L(a(h),o=>(r(),n("tr",{key:o.id,class:"hover:bg-slate-50"},[e("td",Z,[e("div",ee,[o.imageUrl?(r(),n("img",{key:0,src:o.imageUrl,alt:o.name,class:"w-full h-full object-cover"},null,8,te)):(r(),n("div",se,"No imagen"))])]),e("td",oe,[e("div",ae,c(o.name),1)]),e("td",ne,[e("div",re,c(C(o.price)),1)]),e("td",ie,[e("div",ce,c(o.stock??0),1)]),e("td",de,[e("div",le,c(o.category?.name||"Sin categoría"),1)]),e("td",ue,c(k(o.createdAt)),1),e("td",me,[e("div",pe,[e("button",{onClick:$=>D(o),class:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Editar producto"},[d(a(l),{icon:"mdi:pencil",width:"16",height:"16"})],8,xe),e("button",{onClick:$=>N(o),class:"text-red-600 hover:text-red-900 p-1 rounded",title:"Eliminar producto"},[d(a(l),{icon:"mdi:delete",width:"16",height:"16"})],8,he)])])]))),128))])]))]))]),d(z,{"is-visible":u.value,"item-type":"producto","item-name":i.value?.name||"",onConfirm:E,onCancel:A},null,8,["is-visible","item-name"])]))}}),we=T(fe,[["__scopeId","data-v-64b3ab7c"]]);export{we as default};

import{d as k,r as c,o as C,c as n,a as t,b as g,u as f,I as _,t as a,F as h,e as v,f as j,l as V,g as $,n as E,h as r,_ as F}from"./index-C5EFz0i3.js";const S={class:"min-h-screen bg-gray-50 py-8"},N={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},B={class:"mb-6"},D={key:0,class:"flex justify-center py-12"},I={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center"},O={class:"text-red-600 text-sm mb-4"},z={key:2,class:"flex flex-col items-center justify-center min-h-[60vh] text-center"},M={key:3,class:"space-y-6"},A={class:"px-6 py-4"},L={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},P={class:"flex flex-col sm:flex-row sm:items-center gap-4"},T={class:"text-lg font-semibold text-gray-900"},q={class:"text-sm text-gray-500"},H={class:"flex items-center"},R={class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},U={class:"mt-4 sm:mt-0 text-right"},G={class:"text-2xl font-bold text-gray-900"},J={class:"mt-4 flex justify-center"},K=["onClick"],Q={key:0,class:"border-t border-gray-200 px-6 py-4"},W={class:"text-sm font-medium text-gray-700 mb-4"},X={class:"space-y-4"},Y={class:"flex-shrink-0 w-16 h-16"},Z=["src","alt"],tt={class:"flex-grow min-w-0"},st={class:"text-sm font-medium text-gray-900 truncate"},et={class:"text-xs text-gray-500 mt-1 line-clamp-2"},ot={class:"flex items-center mt-2 space-x-4"},at={class:"text-sm text-gray-600"},nt={class:"text-sm text-gray-600"},rt={class:"text-right"},lt={class:"text-lg font-semibold text-gray-900"},it={class:"mt-6 pt-4 border-t border-gray-200"},dt={class:"space-y-2 text-sm"},ct={class:"flex justify-between"},ut={class:"text-gray-900"},xt={class:"flex justify-between"},mt={class:"text-gray-900"},pt={class:"flex justify-between font-semibold text-lg border-t pt-2"},gt={class:"text-gray-900"},ft=k({__name:"purchasesView",setup(_t){const u=c([]),x=c(!0),i=c(null),d=c(new Set);async function p(){try{x.value=!0,i.value=null;const e=await j.get("/orders");u.value=e.data||[]}catch(e){console.error("Error fetching orders:",e),i.value=e.response?.data?.message||"No se pudieron cargar las órdenes",V.error("Error al cargar el historial de compras")}finally{x.value=!1}}function y(e){try{return new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}function b(e){const s=e.target;s.src="https://via.placeholder.com/64x64?text=Sin+Imagen"}function w(e){d.value.has(e)?d.value.delete(e):d.value.add(e)}function m(e){return d.value.has(e)}return C(()=>{p()}),(e,s)=>(r(),n("div",S,[t("div",N,[t("div",B,[t("button",{onClick:s[0]||(s[0]=o=>e.$router.push("/")),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors"},[g(f(_),{icon:"ion:return-up-back",width:"20",height:"20"}),s[1]||(s[1]=t("span",{class:"text-sm font-medium"},"Volver al inicio",-1))])]),s[11]||(s[11]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"Mis Compras"),t("p",{class:"mt-2 text-gray-600"},"Historial de todas tus órdenes")],-1)),x.value?(r(),n("div",D,[...s[2]||(s[2]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)])])):i.value?(r(),n("div",I,[s[3]||(s[3]=t("div",{class:"text-red-800 font-medium mb-2"},"Error al cargar las compras",-1)),t("p",O,a(i.value),1),t("button",{onClick:p,class:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"}," Reintentar ")])):u.value.length===0?(r(),n("div",z,[g(f(_),{icon:"mdi:shop-off",width:"80",height:"80",class:"text-gray-400 mb-4"}),s[4]||(s[4]=t("p",{class:"text-lg text-gray-600 max-w-md"},"No tienes compras realizadas, realiza alguna compra primero",-1))])):(r(),n("div",M,[(r(!0),n(h,null,v(u.value,o=>(r(),n("div",{key:o.id,class:"bg-white rounded-lg shadow-sm border overflow-hidden"},[t("div",A,[t("div",L,[t("div",P,[t("div",null,[t("h3",T,"Orden #"+a(o.id),1),t("p",q,a(y(o.createdAt)),1)]),t("div",H,[t("span",R,a(o.status==="sales"?"Completada":o.status),1)])]),t("div",U,[t("p",G,"$"+a(o.total.toFixed(2)),1),s[5]||(s[5]=t("p",{class:"text-sm text-gray-500"},"Total",-1))])]),t("div",J,[t("button",{onClick:l=>w(o.id),class:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors"},[t("span",null,a(m(o.id)?"Ver menos":"Ver más"),1),(r(),n("svg",{class:E(["w-4 h-4 transform transition-transform duration-200",{"rotate-180":m(o.id)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[6]||(s[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,K)])]),m(o.id)?(r(),n("div",Q,[t("h4",W,"Productos ("+a(o.items.length)+")",1),t("div",X,[(r(!0),n(h,null,v(o.items,l=>(r(),n("div",{key:l.id,class:"flex items-center space-x-4"},[t("div",Y,[t("img",{src:l.product.imageUrl,alt:l.product.name,class:"w-full h-full object-cover rounded-lg border",onError:b},null,40,Z)]),t("div",tt,[t("h5",st,a(l.product.name),1),t("p",et,a(l.product.description),1),t("div",ot,[t("span",at,"Cantidad: "+a(l.quantity),1),t("span",nt,"Precio unit.: $"+a(l.product.price.toFixed(2)),1)])]),t("div",rt,[t("p",lt,"$"+a(l.subtotal.toFixed(2)),1),s[7]||(s[7]=t("p",{class:"text-xs text-gray-500"},"Subtotal",-1))])]))),128))]),t("div",it,[t("div",dt,[t("div",ct,[s[8]||(s[8]=t("span",{class:"text-gray-600"},"Subtotal:",-1)),t("span",ut,"$"+a(o.subtotal.toFixed(2)),1)]),t("div",xt,[s[9]||(s[9]=t("span",{class:"text-gray-600"},"IVA:",-1)),t("span",mt,"$"+a(o.iva.toFixed(2)),1)]),t("div",pt,[s[10]||(s[10]=t("span",{class:"text-gray-900"},"Total:",-1)),t("span",gt,"$"+a(o.total.toFixed(2)),1)])])])])):$("",!0)]))),128))]))])]))}}),vt=F(ft,[["__scopeId","data-v-2f51c209"]]);export{vt as default};

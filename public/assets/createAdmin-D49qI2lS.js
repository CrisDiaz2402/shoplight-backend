import{d as U,r as u,j as A,c as l,a as s,b as v,x as f,u as b,I as x,y as N,g as m,z as c,A as g,n as w,t as p,B as j,v as q,h as n,_ as B}from"./index-C5EFz0i3.js";import{u as S}from"./useUsers-91VFVrqH.js";const D={class:"w-full"},M={class:"mb-6"},O={class:"mb-3"},z={class:"flex items-start justify-between"},F={class:"flex items-center"},I=["disabled"],R={key:0,class:"flex items-center"},L={key:1,class:"flex items-center"},P={class:"w-full"},T={class:"bg-white py-8 px-6 shadow sm:rounded-lg"},G={class:"mt-1"},Y={key:0,class:"mt-2 text-sm text-red-600"},$={class:"mt-1"},H={key:0,class:"mt-2 text-sm text-red-600"},J={class:"mt-1"},K={key:0,class:"mt-2 text-sm text-red-600"},Q={class:"mt-1"},W={key:0,class:"bg-red-50 border border-red-200 rounded-md p-4"},X={class:"flex"},Z={class:"ml-3"},ee={class:"mt-2 text-sm text-red-700"},se=U({__name:"createAdmin",setup(ae){const y=q(),{createUser:_}=S(),a=u({name:"",email:"",password:"",role:"admin"}),d=u(!1),i=u(""),t=u({}),k=A(()=>{const r=!!a.value.name&&a.value.name.trim().length>=2,e=(a.value.email||"").toString().trim(),o=e.length>0&&/.+@.+\..+/.test(e),V=!!a.value.password&&a.value.password.length>=6;return r&&o&&V&&!d.value});function E(){return t.value={},a.value.name.trim()?a.value.name.trim().length<2?t.value.name="El nombre debe tener al menos 2 caracteres":a.value.name.trim().length>100&&(t.value.name="El nombre no puede exceder 100 caracteres"):t.value.name="El nombre es obligatorio",a.value.email.trim()?/.+@.+\..+/.test(a.value.email.trim())||(t.value.email="Formato de email inválido"):t.value.email="El email es obligatorio",a.value.password?a.value.password.length<6&&(t.value.password="La contraseña debe tener al menos 6 caracteres"):t.value.password="La contraseña es obligatoria",Object.keys(t.value).length===0}async function h(){if(E()){d.value=!0,i.value="";try{const r={name:a.value.name.trim(),email:a.value.email.trim(),password:a.value.password,role:a.value.role||"admin"},e=await _(r);y.push({path:"/adminproductos/usuarios",query:{success:"created",name:e.name}})}catch(r){console.error("Error al crear administrador:",r);const e=r?.response?.data?.code,o=r?.response?.data?.message||r?.response?.data?.error;e==="P2002"||o&&/unique|existe|ya existe/i.test(o)?i.value=`Ya existe un usuario con el email "${a.value.email}"`:r?.response?.status===400?i.value=o||"Datos inválidos":i.value=o||"Error inesperado al crear el administrador"}finally{d.value=!1}}}function C(){y.push("/adminproductos/usuarios")}return(r,e)=>(n(),l("div",D,[s("div",M,[s("div",O,[s("button",{onClick:C,type:"button",class:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-800"},[v(b(x),{icon:"mdi:arrow-left",class:"w-5 h-5 mr-2"}),e[4]||(e[4]=f(" Volver ",-1))])]),s("div",z,[e[7]||(e[7]=s("div",{class:"text-left"},[s("h2",{class:"text-3xl font-extrabold text-gray-900"},"Crear Nuevo Administrador"),s("p",{class:"mt-1 text-sm text-gray-600"},"Crea una cuenta de administrador para gestionar la aplicación")],-1)),s("div",F,[s("button",{onClick:h,type:"button",disabled:d.value||!k.value,class:"ml-4 inline-flex items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[d.value?(n(),l("div",R,[...e[5]||(e[5]=[s("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},null,-1),f(" Creando... ",-1)])])):(n(),l("span",L,[v(b(x),{icon:"mdi:content-save",class:"w-4 h-4 mr-2"}),e[6]||(e[6]=f(" Guardar ",-1))]))],8,I)])])]),s("div",P,[s("div",T,[s("form",{onSubmit:N(h,["prevent"]),class:"space-y-6 w-full"},[s("div",null,[e[8]||(e[8]=s("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Nombre *",-1)),s("div",G,[c(s("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>a.value.name=o),type:"text",required:"",maxlength:"100",class:w(["appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":t.value.name}]),placeholder:"Ej: María Pérez"},null,2),[[g,a.value.name]]),t.value.name?(n(),l("p",Y,p(t.value.name),1)):m("",!0)])]),s("div",null,[e[9]||(e[9]=s("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email *",-1)),s("div",$,[c(s("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>a.value.email=o),type:"email",required:"",maxlength:"254",class:w(["appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":t.value.email}]),placeholder:"ejemplo@dominio.com"},null,2),[[g,a.value.email]]),t.value.email?(n(),l("p",H,p(t.value.email),1)):m("",!0)])]),s("div",null,[e[10]||(e[10]=s("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Contraseña *",-1)),s("div",J,[c(s("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=o=>a.value.password=o),type:"password",required:"",minlength:"6",class:w(["appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":t.value.password}]),placeholder:"Al menos 6 caracteres"},null,2),[[g,a.value.password]]),t.value.password?(n(),l("p",K,p(t.value.password),1)):m("",!0)])]),s("div",null,[e[12]||(e[12]=s("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Rol",-1)),s("div",Q,[c(s("select",{id:"role","onUpdate:modelValue":e[3]||(e[3]=o=>a.value.role=o),class:"block w-full rounded-md border-gray-300 shadow-sm sm:text-sm py-2 px-3"},[...e[11]||(e[11]=[s("option",{value:"admin"},"Administrador",-1),s("option",{value:"client"},"Cliente",-1)])],512),[[j,a.value.role]])])]),i.value?(n(),l("div",W,[s("div",X,[v(b(x),{icon:"mdi:alert-circle",class:"h-5 w-5 text-red-400"}),s("div",Z,[e[13]||(e[13]=s("h3",{class:"text-sm font-medium text-red-800"},"Error al crear administrador",-1)),s("div",ee,p(i.value),1)])])])):m("",!0)],32)])])]))}}),re=B(se,[["__scopeId","data-v-11d29911"]]);export{re as default};

import{d as R,r as g,o as q,s as j,l as m,v as B,c as o,a as e,b as l,u as a,I as c,x as I,t as d,F as T,e as V,h as i,_ as z}from"./index-C5EFz0i3.js";import{u as F}from"./useUsers-91VFVrqH.js";import{D as L}from"./deletedPanel-It5FEFuC.js";const M={class:"space-y-6"},S={class:"bg-white text-slate-900 p-8 rounded-md border border-slate-200"},G={class:"flex items-center justify-between gap-4"},P={key:0,class:"flex items-center justify-center p-8"},Q={key:1,class:"bg-red-50 border border-red-200 rounded-md p-4 text-red-700"},H={class:"flex items-center"},J={key:2,class:"bg-white rounded-lg shadow overflow-hidden"},K={key:0,class:"text-center py-12"},O={class:"text-slate-500"},W={key:1,class:"min-w-full"},X={class:"bg-white divide-y divide-slate-200"},Y={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-sm font-medium text-slate-900"},ee={class:"px-6 py-4"},te={class:"text-sm text-slate-500"},se={class:"px-6 py-4 text-center"},ae={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-500"},ie={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ne={class:"flex items-center justify-end gap-2"},re=["onClick"],le=["onClick"],de=R({__name:"usersAdmin",setup(ce){const p=B(),x=j(),{filteredUsers:h,loading:y,error:f,searchQuery:v,fetchUsers:_,deleteUser:b,clearError:w}=F(),u=g(!1),n=g(null);q(async()=>{await _();const t=x.query.success,s=x.query.name;t&&s&&(setTimeout(()=>{t==="created"?m.success(`Usuario "${s}" creado exitosamente`,{autoClose:2e3}):t==="updated"&&m.success(`Usuario "${s}" actualizado exitosamente`,{autoClose:2e3})},100),p.replace({path:x.path}))});function k(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}}function C(){p.push("/adminproductos/usuarios/crear")}function D(t){p.push(`/adminproductos/usuarios/${t.id}/editar`)}function A(t){n.value=t,u.value=!0}async function E(){if(n.value)try{const t=n.value.name;await b(n.value.id),m.success(`Usuario "${t}" eliminado exitosamente`,{autoClose:2e3}),u.value=!1,n.value=null}catch(t){console.error("Error al eliminar usuario:",t);const s=t?.response?.data?.error||t?.response?.data?.message||"Error al eliminar el usuario";m.error(s,{autoClose:2e3})}}function N(){u.value=!1,n.value=null}function U(){w(),_()}return(t,s)=>(i(),o("section",M,[e("header",S,[e("div",G,[s[1]||(s[1]=e("div",null,[e("h1",{class:"text-3xl md:text-4xl font-extrabold"},"Gestión de Administradores"),e("p",{class:"text-slate-600 mt-2"},"Administra los usuarios del sistema")],-1)),e("button",{onClick:C,class:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md shadow"},[l(a(c),{icon:"mdi:plus",width:"18",height:"18"}),s[0]||(s[0]=e("span",null,"Crear Administrador",-1))])])]),e("main",null,[a(y)?(i(),o("div",P,[...s[2]||(s[2]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),e("span",{class:"ml-2 text-slate-600"},"Cargando administradores...",-1)])])):a(f)?(i(),o("div",Q,[e("div",H,[l(a(c),{icon:"mdi:alert-circle",width:"20",height:"20",class:"mr-2"}),I(" "+d(a(f)),1)]),e("button",{onClick:U,class:"mt-2 text-red-800 underline hover:no-underline"},"Reintentar")])):(i(),o("div",J,[a(h).length===0?(i(),o("div",K,[l(a(c),{icon:"mdi:account-group-outline",width:"48",height:"48",class:"mx-auto text-slate-300 mb-4"}),s[3]||(s[3]=e("h3",{class:"text-lg font-medium text-slate-900 mb-2"},"No hay administradores",-1)),e("p",O,d(a(v)?"No se encontraron administradores que coincidan con tu búsqueda.":"Comienza creando tu primer administrador."),1)])):(i(),o("table",W,[s[4]||(s[4]=e("thead",{class:"bg-slate-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Nombre"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Email"),e("th",{class:"px-6 py-3 text-center text-xs font-medium text-slate-500 uppercase tracking-wider"},"Rol"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"},"Creado"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",X,[(i(!0),o(T,null,V(a(h),r=>(i(),o("tr",{key:r.id,class:"hover:bg-slate-50"},[e("td",Y,[e("div",Z,d(r.name),1)]),e("td",ee,[e("div",te,d(r.email),1)]),e("td",se,[e("span",ae,d(r.role||"client"),1)]),e("td",oe,d(k(r.createdAt)),1),e("td",ie,[e("div",ne,[e("button",{onClick:$=>D(r),class:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Editar usuario"},[l(a(c),{icon:"mdi:pencil",width:"16",height:"16"})],8,re),e("button",{onClick:$=>A(r),class:"text-red-600 hover:text-red-900 p-1 rounded",title:"Eliminar usuario"},[l(a(c),{icon:"mdi:delete",width:"16",height:"16"})],8,le)])])]))),128))])]))]))]),l(L,{"is-visible":u.value,"item-type":"usuario","item-name":n.value?.name||"",onConfirm:E,onCancel:N},null,8,["is-visible","item-name"])]))}}),xe=z(de,[["__scopeId","data-v-defea5c6"]]);export{xe as default};
